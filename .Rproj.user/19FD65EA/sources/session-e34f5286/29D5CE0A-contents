library(rhandsontable)
library(DBI)
con <- DBI::dbConnect(
  RPostgres::Postgres(),
  dbname = "postgres",
  user = "joey",
  host = "data.pr.uoguelph.ca",
  port = "5432",
  password = "root",
)

shinyServer(function(input, output, session) {
  observe({
    # remove button and isolate to update file automatically
    # after each table change
    input$saveBtn
    hot = isolate(input$hot)
    if (!is.null(hot)) {
      dbWriteTable(con, "mtcars", hot_to_r(input$hot), overwrite = TRUE)
      print("saved")
    }
  })

  output$hot = renderRHandsontable({
    if (!is.null(input$hot)) {
      DF = hot_to_r(input$hot)
    } else {
      #DF = read.csv("mtcars.csv", stringsAsFactors = FALSE)
      DF = dbReadTable(con, "mtcars")
    }

    rhandsontable(DF) %>%
        hot_table(highlightCol = TRUE, highlightRow = TRUE)
  })
})
